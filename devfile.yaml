apiVersion: 1.0.0
metadata:
  generateName: che-dashboard-react-
attributes:
  persistVolumes: 'false'
components:
  - mountSources: true
    endpoints:
      - attributes:
          public: 'true'
          protocol: http
          path: /
        name: dashboard-dev-server
        port: 3000
    command:
      - tail
      - '-f'
      - /dev/null
    memoryLimit: 3Gi
    type: dockerimage
    alias: dashboard-dev
    image: 'docker.io/node:12'
  - id: vscode/typescript-language-features/latest
    type: chePlugin
commands:
  - name: '[UD] install dependencies'
    actions:
      - workdir: /projects/che-dashboard
        type: exec
        command: yarn install --ignore-optional --non-interactive
        component: dashboard-dev
  - name: '[UD] compile'
    actions:
      - workdir: /projects/che-dashboard
        type: exec
        command: yarn install --ignore-optional --non-interactive && yarn compile
        component: dashboard-dev
  - name: '[UD] test'
    actions:
      - workdir: /projects/che-dashboard
        type: exec
        command: yarn install --ignore-optional --non-interactive && yarn test
        component: dashboard-dev
  - name: '[UD] start'
    actions:
      - workdir: /projects/che-dashboard
        type: exec
        command: 'yarn install --ignore-optional --non-interactive && yarn start --env.server=${CHE_API_EXTERNAL%????}'
        component: dashboard-dev
  - name: '[UD] start [API Backend che.openshift.io]'
    actions:
      - workdir: /projects/che-dashboard
        type: exec
        command: yarn install --ignore-optional --non-interactive && yarn start
        component: dashboard-dev
